(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c056df6"],{4265:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"own-space"},[a("Card",[a("Tabs",{attrs:{animated:!1}},[a("TabPane",{attrs:{label:"基本信息",name:"info"}},[a("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":100,"label-position":"right"}},[a("FormItem",{attrs:{label:"用户头像："}},[e._l(e.uploadList,(function(t){return a("div",{key:t.url,staticClass:"upload-list"},["finished"===t.status?[a("img",{attrs:{src:t.url}}),e._v(" "),a("div",{staticClass:"upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(i){return e.handleView(t.url)}}}),e._v(" "),a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(i){return e.handleRemove(t)}}})],1)]:[t.showProgress?a("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)})),e._v(" "),a("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":e.defaultList,"on-success":e.handleSuccess,"on-error":e.handleError,format:["jpg","jpeg","png","gif"],"max-size":5120,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,type:"drag",action:e.uploadFileUrl,headers:e.accessToken}},[a("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[a("Icon",{attrs:{type:"md-camera",size:"20"}})],1)])],2),e._v(" "),a("FormItem",{attrs:{label:"用户账号："}},[a("span",[e._v(e._s(e.userForm.username))])]),e._v(" "),a("FormItem",{attrs:{label:"性别："}},[a("RadioGroup",{model:{value:e.userForm.sex,callback:function(t){e.$set(e.userForm,"sex",t)},expression:"userForm.sex"}},e._l(e.dictSex,(function(t,i){return a("Radio",{key:i,attrs:{label:Number(t.value)}},[e._v(e._s(t.title))])})),1)],1),e._v(" "),a("FormItem",{attrs:{label:"手机号："}},[a("span",[e._v(e._s(e.userForm.mobile))]),e._v(" "),a("div",{staticStyle:{display:"inline-block","margin-left":"20px","font-size":"13px"}},[a("a",{on:{click:e.showChangeMobile}},[e._v("修改手机号")])])]),e._v(" "),a("FormItem",{attrs:{label:"邮箱："}},[a("span",[e._v(e._s(e.userForm.email))]),e._v(" "),a("div",{staticStyle:{display:"inline-block","margin-left":"20px","font-size":"13px"}},[a("a",{on:{click:e.showChangeEmail}},[e._v("修改邮箱")])])]),e._v(" "),a("FormItem",{attrs:{label:"地址："}},[a("al-cascader",{staticStyle:{width:"250px"},attrs:{"data-type":"code",level:"2"},on:{"on-change":e.changeAddress},model:{value:e.userForm.addressArray,callback:function(t){e.$set(e.userForm,"addressArray",t)},expression:"userForm.addressArray"}})],1),e._v(" "),a("FormItem",{attrs:{label:"所属部门："}},[a("span",[e._v(e._s(e.userForm.departmentTitle))])]),e._v(" "),a("FormItem",{attrs:{label:"用户类型："}},[a("span",[e._v(e._s(e.userForm.typeTxt))])]),e._v(" "),a("FormItem",{attrs:{label:"创建时间："}},[a("span",[e._v(e._s(e.userForm.createTime))])]),e._v(" "),a("FormItem",[a("Button",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{type:"primary",loading:e.saveLoading},on:{click:e.saveEdit}},[e._v("保存")]),e._v(" "),a("Button",{on:{click:e.cancelEditUserInfo}},[e._v("取消")])],1)],1)],1),e._v(" "),a("TabPane",{attrs:{label:"绑定第三方账号",name:"social"}},[a("div",{staticClass:"sorry"},[a("img",{attrs:{src:i("98ce")}}),e._v(" "),a("span",{staticClass:"text"},[e._v("抱歉,功能暂不支持")])])])],1)],1),e._v(" "),a("Modal",{attrs:{title:"修改手机号",closable:!1,"mask-closable":!1,width:500},model:{value:e.editMobileVisible,callback:function(t){e.editMobileVisible=t},expression:"editMobileVisible"}},[a("Form",{ref:"mobileEditForm",attrs:{model:e.mobileEditForm,"label-width":60,rules:e.mobileEditValidate}},[a("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[a("Input",{attrs:{placeholder:"请输入新手机号"},on:{"on-change":e.hasChangePhone},model:{value:e.mobileEditForm.mobile,callback:function(t){e.$set(e.mobileEditForm,"mobile",t)},expression:"mobileEditForm.mobile"}})],1),e._v(" "),a("FormItem",{attrs:{label:"验证码",prop:"code",error:e.codeError}},[a("Input",{staticStyle:{width:"200px","margin-right":"5px"},attrs:{placeholder:"请输入您收到的短信验证码"},model:{value:e.mobileEditForm.code,callback:function(t){e.$set(e.mobileEditForm,"code",t)},expression:"mobileEditForm.code"}}),e._v(" "),a("div",{staticStyle:{display:"inline-block",position:"relative"}},[a("Button",{attrs:{disabled:e.canGetIdentifyCode},on:{click:e.getIdentifyCode}},[e._v(e._s(e.gettingIdentifyCodeBtnContent))])],1)],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancelInputCodeBox}},[e._v("取消")]),e._v(" "),a("Button",{attrs:{type:"primary",loading:e.checkIdentifyCodeLoading},on:{click:e.submitCode}},[e._v("提交")])],1)],1),e._v(" "),a("Modal",{attrs:{title:"修改邮箱",closable:!1,"mask-closable":!1,width:500},model:{value:e.editEmailVisible,callback:function(t){e.editEmailVisible=t},expression:"editEmailVisible"}},[a("Form",{ref:"emailEditForm",attrs:{model:e.emailEditForm,"label-width":90,rules:e.emailEditValidate}},[a("FormItem",{attrs:{label:"新邮箱地址",prop:"email"}},[a("Input",{attrs:{placeholder:"请输入新邮箱地址"},on:{"on-change":e.hasChangeEmail},model:{value:e.emailEditForm.email,callback:function(t){e.$set(e.emailEditForm,"email",t)},expression:"emailEditForm.email"}})],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:e.cancelEditEmail}},[e._v("取消")]),e._v(" "),a("Button",{attrs:{type:"primary",disabled:e.canSendEditEmail,loading:e.sendVerifyEmailLoading},on:{click:e.sendVerifyEmail}},[e._v("发送验证邮件")])],1)],1),e._v(" "),a("Modal",{attrs:{title:"图片预览",draggable:""},model:{value:e.viewImage,callback:function(t){e.viewImage=t},expression:"viewImage"}},[a("img",{staticStyle:{width:"80%",margin:"0 auto",display:"block"},attrs:{src:e.imgUrl}}),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:function(t){e.viewImage=!1}}},[e._v("关闭")])],1)])],1)},s=[],o=(i("7f7f"),i("6b54"),i("365c")),r=i("a78e"),n=i.n(r),l={name:"ownspace_index",data:function(){var e=function(e,t,i){var a=/^1[0-9]{10}$/;a.test(t)?i():i(new Error("请输入正确格式的手机号"))};return{accessToken:{},uploadFileUrl:o["bb"],userForm:{id:"",avatar:"",username:"",sex:"",mobile:"",email:"",status:"",type:"",typeTxt:"",address:"",addressArray:[]},mobileEditForm:{mobile:"",code:""},emailEditForm:{email:""},defaultList:[{url:""}],uploadList:[],viewImage:!1,imgUrl:"",codeError:"",initPhone:"",initEmail:"",uid:"",saveLoading:!1,identifyError:"",savePassLoading:!1,oldPassError:"",identifyCodeRight:!1,hasGetIdentifyCode:!1,canGetIdentifyCode:!1,checkIdentifyCodeLoading:!1,mobileEditValidate:{mobile:[{required:!0,message:"请输入手机号码"},{validator:e}]},emailEditValidate:{email:[{required:!0,message:"请输入邮箱地址"},{type:"email",message:"邮箱格式不正确"}]},editMobileVisible:!1,gettingIdentifyCodeBtnContent:"获取验证码",editEmailVisible:!1,sendVerifyEmailLoading:!1,canSendEditEmail:!0,github:{related:!1,id:"",username:""},qq:{related:!1,id:"",username:""},weibo:{related:!1,id:"",username:""},jumping:!1,dictSex:[]}},methods:{init:function(){this.getDictSexData(),this.accessToken={accessToken:this.getStore("accessToken")};var e=JSON.parse(n.a.get("userInfo"));for(var t in e)null===e[t]&&(e[t]="");var i=JSON.stringify(e),a=JSON.parse(i);a.addressArray=[],this.userForm=a,this.initPhone=a.mobile,this.mobileEditForm.mobile=a.mobile,this.initEmail=a.email,this.emailEditForm.email=a.email,this.defaultList[0].url=a.avatar,null!==a.address&&""!==a.address&&(this.userForm.address=a.address,this.userForm.addressArray=JSON.parse(a.address)),0===this.userForm.type?this.userForm.typeTxt="普通用户":1===this.userForm.type&&(this.userForm.typeTxt="管理员")},getDictSexData:function(){var e=this;Object(o["I"])("sex").then((function(t){t.success&&(e.dictSex=t.result)}))},handleView:function(e){this.imgUrl=e,this.viewImage=!0},handleRemove:function(e){var t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess:function(e,t){!0===e.success?(t.url=e.result,this.userForm.avatar=e.result,this.defaultList[0].url=e.result,this.$refs.upload.fileList.splice(0,1)):this.$Message.error(e.message)},handleError:function(e,t,i){this.$Message.error(e.toString())},handleFormatError:function(e){this.$Notice.warning({title:"不支持的文件格式",desc:"所选文件‘ "+e.name+" ’格式不正确, 请选择 .jpg .jpeg .png .gif格式文件"})},handleMaxSize:function(e){this.$Notice.warning({title:"文件大小过大",desc:"所选文件‘ "+e.name+" ’大小过大, 不得超过 5M."})},handleBeforeUpload:function(){var e=this.uploadList.length<2;return e||this.$Notice.warning({title:"最多只能上传 1 张图片"}),e},showChangeMobile:function(){this.editMobileVisible=!0},showChangeEmail:function(){this.editEmailVisible=!0},getIdentifyCode:function(){var e=this;this.hasGetIdentifyCode=!0,this.$refs["mobileEditForm"].validate((function(t){if(t){e.canGetIdentifyCode=!0;var i=60,a=setInterval((function(){i>=0?(e.gettingIdentifyCodeBtnContent=i+"秒后重试",i-=1):(clearInterval(a),e.gettingIdentifyCodeBtnContent="获取验证码",e.canGetIdentifyCode=!1)}),1e3);e.editMobileVisible=!0}}))},cancelEditUserInfo:function(){this.$store.commit("removeTag","ownspace_old"),localStorage.pageOpenedList=JSON.stringify(this.$store.state.app.pageOpenedList);var e="",t=this.$store.state.app.pageOpenedList.length;e=t>1?this.$store.state.app.pageOpenedList[t-1].name:this.$store.state.app.pageOpenedList[0].name,this.$router.push({name:e})},saveEdit:function(){var e=this;this.saveLoading=!0;var t=this.userForm;delete t.nickName,delete t.description,Object(o["db"])(t).then((function(t){e.saveLoading=!1,!0===t.success&&(e.$Message.success("保存成功"),n.a.set("userInfo",e.userForm),e.$store.commit("setAvatarPath",e.userForm.avatar))}))},changeAddress:function(){this.userForm.address=JSON.stringify(this.userForm.addressArray)},cancelInputCodeBox:function(){this.editMobileVisible=!1,this.userForm.mobile=this.initPhone},cancelEditEmail:function(){this.editEmailVisible=!1,this.emailEditForm.email=this.initEmail},submitCode:function(){var e=this;this.checkIdentifyCodeLoading=!0,this.$refs["mobileEditForm"].validate((function(t){if(t){if(0===e.mobileEditForm.code.length)return e.codeError="请填写短信验证码",void(e.checkIdentifyCodeLoading=!1);e.$Message.success("修改成功"),e.editMobileVisible=!1,e.checkIdentifyCodeLoading=!1}}))},hasChangePhone:function(){var e=this;this.mobileEditForm.mobile===this.initPhone?this.canGetIdentifyCode=!0:this.$refs["mobileEditForm"].validate((function(t){e.canGetIdentifyCode=!t}))},hasChangeEmail:function(){this.emailEditForm.email===this.initEmail?this.canSendEditEmail=!0:this.canSendEditEmail=!1},sendVerifyEmail:function(){var e=this;this.$refs["emailEditForm"].validate((function(t){t&&(e.sendVerifyEmailLoading=!0,setTimeout((function(){e.sendVerifyEmailLoading=!1,e.editEmailVisible=!1,e.$Message.success("发送验证邮件成功，请注意查收")}),1e3))}))}},mounted:function(){this.uploadList=this.$refs.upload.fileList,this.init(),this.hasChangePhone()}},d=l,c=(i("9c99"),i("2877")),m=Object(c["a"])(d,a,s,!1,null,null,null);t["default"]=m.exports},8739:function(e,t,i){},"98ce":function(e,t,i){e.exports=i.p+"static/img/sorry.5613b8c6.png"},"9c99":function(e,t,i){"use strict";var a=i("8739"),s=i.n(a);s.a}}]);