(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6be6f586","chunk-2d0c8dba"],{5757:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Cascader",{style:{width:e.width},attrs:{data:e.department,"load-data":e.loadData,"change-on-select":"",filterable:"",clearable:"",placeholder:"请选择或输入搜索部门"},on:{"on-change":e.handleChangeDep},model:{value:e.selectDep,callback:function(t){e.selectDep=t},expression:"selectDep"}})],1)},r=[],n=(s("ac6a"),s("365c")),i={name:"departmentChoose",props:{width:{type:String,default:"200px"}},data:function(){return{selectDep:[],department:[]}},methods:{initDepartmentData:function(){var e=this;Object(n["Q"])().then((function(t){!0===t.success&&(t.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title),-1===e.status&&(e.label="[已禁用] "+e.label,e.disabled=!0)})),e.department=t.result)}))},loadData:function(e,t){e.loading=!0,Object(n["R"])(e.value).then((function(s){e.loading=!1,!0===s.success&&(s.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title),-1===e.status&&(e.label="[已禁用] "+e.label,e.disabled=!0)})),e.children=s.result,t())}))},handleChangeDep:function(e,t){var s="";e&&e.length>0&&(s=e[e.length-1]),this.$emit("on-select",s)},clearSelect:function(){this.selectDep=[]}},created:function(){this.initDepartmentData()}},l=i,c=s("2877"),o=Object(c["a"])(l,a,r,!1,null,null,null);t["default"]=o.exports},"810c":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Button",{attrs:{icon:e.icon},on:{click:function(t){e.userModalVisible=!0}}},[e._v(e._s(e.buttonText))]),e._v(" "),s("span",{staticClass:"clear",on:{click:e.clearSelectUser}},[e._v("清空已选")]),e._v(" "),s("Collapse",{staticClass:"collapse",attrs:{simple:""}},[s("Panel",{attrs:{name:"1"}},[e._v("\n      已选择\n      "),s("span",{staticClass:"select-count"},[e._v(e._s(e.selectUsers.length))]),e._v(" 人\n      "),s("p",{attrs:{slot:"content"},slot:"content"},e._l(e.selectUsers,(function(t,a){return s("Tag",{key:a,attrs:{name:t.id,color:"default",closable:""},on:{"on-close":e.handleCancelUser}},[e._v(e._s(t.username))])})),1)])],1),e._v(" "),s("Drawer",{attrs:{title:"选择用户",closable:"",width:"800",draggable:""},model:{value:e.userModalVisible,callback:function(t){e.userModalVisible=t},expression:"userModalVisible"}},[s("Form",{ref:"searchUserForm",staticClass:"search-form",attrs:{model:e.searchUserForm,inline:"","label-width":55}},[s("Form-item",{attrs:{label:"用户名",prop:"username"}},[s("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入用户名"},model:{value:e.searchUserForm.username,callback:function(t){e.$set(e.searchUserForm,"username",t)},expression:"searchUserForm.username"}})],1),e._v(" "),s("Form-item",{attrs:{label:"部门",prop:"department"}},[s("department-choose",{ref:"dep",on:{"on-select":e.handleSelectDep}})],1),e._v(" "),s("Form-item",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[s("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearchUser}},[e._v("搜索")]),e._v(" "),s("Button",{on:{click:e.handleResetUser}},[e._v("重置")])],1)],1),e._v(" "),s("Table",{ref:"userTable",attrs:{loading:e.userLoading,border:"",columns:e.userColumns,data:e.userData}}),e._v(" "),s("Row",{staticClass:"code-row-bg page",staticStyle:{margin:"10px 0"},attrs:{type:"flex",justify:"end"}},[s("Page",{attrs:{current:e.searchUserForm.pageNumber,total:e.totalUser,"page-size":e.searchUserForm.pageSize,"page-size-opts":[9,18,36],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changeUserPage,"on-page-size-change":e.changeUserPageSize}})],1),e._v(" "),s("div",{staticClass:"drawer-footer"},[e._v("\n      已选择\n      "),s("span",{staticClass:"select-count"},[e._v(e._s(e.selectUsers.length))]),e._v(" 人\n      "),s("Button",{staticStyle:{"margin-left":"10px"},on:{click:e.clearSelectUser}},[e._v("清空已选")]),e._v(" "),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"info"},on:{click:e.setSelectAllUser}},[e._v("勾选全部")]),e._v(" "),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){e.userModalVisible=!1}}},[e._v("关闭")])],1)],1)],1)},r=[],n=(s("ac6a"),s("365c")),i=s("5757"),l={name:"userChoose",components:{departmentChoose:i["default"]},props:{buttonText:{type:String,default:"选择用户"},icon:{type:String,default:"md-person-add"}},data:function(){var e=this;return{userLoading:!0,userModalVisible:!1,selectUsers:[],searchUserForm:{username:"",type:"",status:"",pageNumber:1,pageSize:9,sort:"createTime",order:"desc"},userColumns:[{type:"index",width:60,align:"center"},{title:"用户名",key:"username",width:145,sortable:!0},{title:"头像",key:"avatar",width:80,align:"center",render:function(e,t){return e("Avatar",{props:{src:t.row.avatar}})}},{title:"所属部门",key:"departmentTitle",width:120},{title:"手机",key:"mobile",width:115,sortable:!0},{title:"邮箱",key:"email",width:180,sortable:!0},{title:"性别",key:"sex",width:70,align:"center",render:function(t,s){var a="";return e.dictSex.forEach((function(e){e.value==s.row.sex&&(a=e.title)})),t("div",a)}},{title:"用户类型",key:"type",align:"center",width:100,render:function(e,t){var s="";return 1===t.row.type?s="管理员":0===t.row.type&&(s="普通用户"),e("div",s)}},{title:"状态",key:"status",align:"center",width:120,render:function(e,t){return 0===t.row.status?e("div",[e("Tag",{props:{color:"green"}},"正常启用")]):-1===t.row.status?e("div",[e("Tag",{props:{color:"red"}},"禁用")]):void 0}},{title:"创建时间",key:"createTime",sortable:!0,sortType:"desc",width:150},{title:"操作",key:"action",width:130,align:"center",fixed:"right",render:function(t,s){return t("div",[t("Button",{props:{type:"info",size:"small"},on:{click:function(){e.chooseUser(s.row)}}},"添加该用户")])}}],userData:[],totalUser:0,dictMessageType:[]}},methods:{getDictDataType:function(){var e=this;Object(n["I"])("message_type").then((function(t){t.success&&(e.dictMessageType=t.result)})),Object(n["I"])("sex").then((function(t){t.success&&(e.dictSex=t.result)}))},handleSelectDep:function(e){this.searchUserForm.departmentId=e},changeUserPage:function(e){this.searchUserForm.pageNumber=e,this.getUserDataList()},changeUserPageSize:function(e){this.searchUserForm.pageSize=e,this.getUserDataList()},getUserDataList:function(){var e=this;this.userLoading=!0,Object(n["O"])(this.searchUserForm).then((function(t){e.userLoading=!1,!0===t.success&&(e.userData=t.result.content,e.totalUser=t.result.totalElements)}))},handleSearchUser:function(){this.searchUserForm.pageNumber=1,this.searchUserForm.pageSize=9,this.getUserDataList()},handleResetUser:function(){this.$refs.searchUserForm.resetFields(),this.searchUserForm.pageNumber=1,this.searchUserForm.pageSize=9,this.$refs.dep.clearSelect(),this.searchUserForm.departmentId="",this.getUserDataList()},setSelectUser:function(e){this.selectUsers=e},setSelectAllUser:function(){var e=[];this.userData.forEach((function(t){var s={id:t.id,username:t.username};e.push(s)})),this.selectUsers=e,this.$emit("on-change",e)},chooseUser:function(e){var t=this,s=!0;if(this.selectUsers.forEach((function(a){e.id==a.id&&(t.$Message.warning("已经添加过啦，请勿重复选择"),s=!1)})),s){var a={id:e.id,username:e.username};this.selectUsers.push(a),this.$emit("on-change",this.selectUsers),this.$Message.success("添加用户 ".concat(e.username," 成功"))}},clearSelectUser:function(){this.selectUsers=[],this.$emit("on-change",this.selectUsers)},handleCancelUser:function(e,t){var s=[];this.selectUsers.forEach((function(e){t!=e.id&&s.push(e)})),this.selectUsers=s,this.$emit("on-change",this.selectUsers),this.$Message.success("删除所选用户成功")}},created:function(){this.getDictDataType(),this.getUserDataList()}},c=l,o=(s("afbd"),s("2877")),u=Object(o["a"])(c,a,r,!1,null,null,null);t["default"]=u.exports},"90ed":function(e,t,s){},afbd:function(e,t,s){"use strict";var a=s("90ed"),r=s.n(a);r.a}}]);